<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Protected Videos</title>
<style>
  :root{--bg:#000;--fg:#fff;--muted:#999;}
  html,body{height:100%}
  body{
    margin:0;background:var(--bg);color:var(--fg);
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
    scroll-behavior:smooth; scroll-snap-type:y mandatory; overscroll-behavior-y:none;
  }
  .panel{ height:100vh; min-height:100dvh; display:flex; align-items:center; justify-content:center; padding:12px; box-sizing:border-box; scroll-snap-align:start; }
  .wrap{ width:100%; max-width:1200px; margin:auto; }
  .player{ position:relative; width:100%; aspect-ratio:16/9; box-shadow:0 10px 30px rgba(0,0,0,.6); border-radius:12px; overflow:hidden; background:#111; }
  iframe{ width:100%; height:100%; border:0; display:block; }
  .label{ margin-top:8px; font-size:14px; color:var(--muted); }
  .hint{ position:fixed; left:50%; transform:translateX(-50%); bottom:10px; font-size:12px; color:#bbb; opacity:.85; }
  .hidden{ display:none!important; }
  .noscript{ display:grid; place-items:center; min-height:100dvh; padding:24px; text-align:center; color:#bbb; }

  /* password modal */
  .gate{ position:fixed; inset:0; display:grid; place-items:center; background:rgba(0,0,0,0.88); z-index:9999;}
  .card{ width:calc(100% - 40px); max-width:420px; background:#0b0b0b; border-radius:10px; padding:18px; color:#eee; box-shadow:0 8px 30px rgba(0,0,0,.6); }
  label{ display:block; margin-bottom:8px; color:#bbb; font-size:14px;}
  input{ width:100%; padding:10px; border-radius:8px; border:1px solid #222; background:#050505; color:#fff; box-sizing:border-box;}
  button{ margin-top:12px; width:100%; padding:10px; border-radius:8px; border:0; background:#1a73e8; color:white; font-weight:600;}
  .small{ font-size:12px; color:#999; margin-top:8px; text-align:center; }
</style>
</head>
<body>
  <noscript>
    <div class="noscript">
      JavaScript is required — you will be redirected.
      <meta http-equiv="refresh" content="0; url=https://www.google.com" />
    </div>
  </noscript>

  <div id="root"></div>
  <div class="hint" id="hint">Scroll to move to the next video ▾</div>

  <!-- Videos array (safe on GitHub Pages) -->
  <script>
  window.VIDEOS = [
    { "url": "https://www.youtube.com/shorts/pqe4S4325q8", "title": "0" },
    { "url": "https://www.youtube.com/watch?v=27cA9ptT6QE", "title": "1" },
    { "url": "https://www.youtube.com/watch?v=daTJMhWTxTs", "title": "2" },
    { "url": "https://www.youtube.com/watch?v=oCnotRXfR_M", "title": "3" },
    { "url": "https://www.youtube.com/watch?v=rc4fype-Mo8", "title": "4" },
    { "url": "https://youtube.com/shorts/dIV0SyLqiVs", "title": "5" },
    { "url": "https://www.youtube.com/watch?v=_WU_fdDpeLw", "title": "6" },
    { "url": "https://www.youtube.com/watch?v=5D0tWISEvn0", "title": "7" },
    { "url": "https://youtu.be/wS4D4Z1_5LQ", "title": "8" },
    { "url": "https://youtu.be/gAVs4er6kn0", "title": "9" },
    { "url": "https://youtu.be/A8w2OR2xGj4", "title": "10" },
    { "url": "https://youtu.be/hsFsDTObQAU", "title": "11" },
    { "url": "https://youtube.com/shorts/t-opht7pIUI?feature=share", "title": "12" },
    { "url": "https://youtube.com/shorts/cS82Yr76OAM?feature=share", "title": "13" },
    { "url": "https://youtube.com/shorts/fhxjJ8h7fSk?feature=share", "title": "14" },
    { "url": "https://youtube.com/shorts/27keArNQ4wc?feature=share", "title": "15" },
    { "url": "https://www.youtube.com/watch?v=b0a6M5SaQQM", "title": "16" },

    { "url": "https://www.facebook.com/reel/2261531724322163", "title": "FB reel" },
    { "url": "https://www.facebook.com/reel/704439259299017", "title": "FB reel" },
    { "url": "https://www.facebook.com/reel/800437302387247", "title": "FB reel" },
    { "url": "https://www.facebook.com/61581175712529/videos/1292717129011948", "title": "FB reel" },
    { "url": "https://www.facebook.com/watch?v=1125590846371845", "title": "FB reel" },

    { "url": "https://youtube.com/shorts/T-evQX6mpp4", "title": "end" }
  ];
  </script>

  <!-- SIMPLE AUTH CONFIG (salted SHA-256) -->
  <script id="auth-config" type="application/json">
  {
    "salt_base64url":"X9LtQaHELAPK7FNW",
    "reference_hex":"7ecedf92ee1127df7c3e74900641527742678186504680722469bc3ef797fbaa"
  }
  </script>

  <!-- password modal -->
  <div class="gate" id="gate">
    <div class="card" role="dialog" aria-labelledby="title">
      <div id="title" style="font-size:18px;font-weight:700;margin-bottom:8px">Protected Access</div>
      <label for="pwd">Password</label>
      <input id="pwd" type="password" autocomplete="current-password" />
      <button id="btn">Unlock</button>
      <div class="small">Wrong password → redirected to Google</div>
    </div>
  </div>

<script>
/* === Config === */
const PASSWORD_REQUIRED = false; // set true if you want the gate

/* === Hash helpers === */
function b64urlToArrayBuffer(b64url){
  const b64 = b64url.replace(/-/g,'+').replace(/_/g,'/');
  const pad = b64.length % 4;
  const s = b64 + (pad ? '='.repeat(4 - pad) : '');
  const bin = atob(s);
  const u = new Uint8Array(bin.length);
  for(let i=0;i<bin.length;i++) u[i]=bin.charCodeAt(i);
  return u.buffer;
}
function bufToHex(buf){
  const u = new Uint8Array(buf);
  return Array.from(u).map(b=>b.toString(16).padStart(2,'0')).join('');
}
async function sha256OfSaltPlusPassword(saltBuf, password){
  const enc = new TextEncoder();
  const pwdBuf = enc.encode(password);
  const saltBytes = new Uint8Array(saltBuf);
  const concat = new Uint8Array(saltBytes.length + pwdBuf.length);
  concat.set(saltBytes, 0);
  concat.set(pwdBuf, saltBytes.length);
  const digest = await crypto.subtle.digest('SHA-256', concat.buffer);
  return bufToHex(digest);
}
async function verifyPassword(password, cfg){
  try{
    const saltBuf = b64urlToArrayBuffer(cfg.salt_base64url);
    const hex = await sha256OfSaltPlusPassword(saltBuf, password);
    return hex === cfg.reference_hex;
  }catch(e){
    console.warn('verify error', e);
    return false;
  }
}

/* === Platform detection === */
function detectPlatform(urlStr){
  try{
    const u = new URL(urlStr);
    const h = u.hostname.toLowerCase();
    if (h.includes('youtube.com') || h.includes('youtu.be')) return 'youtube';
    if (h.includes('facebook.com') || h.includes('fb.watch')) return 'facebook';
  }catch(e){}
  return null;
}
function extractYouTubeId(urlStr){
  try{
    const u = new URL(urlStr);
    if (u.hostname.includes('youtu.be')) return u.pathname.slice(1);
    if (u.pathname.startsWith('/shorts/')){
      const parts = u.pathname.split('/');
      if (parts.length >= 3) return parts[2];
    }
    if (u.searchParams.get('v')) return u.searchParams.get('v');
  }catch(e){}
  return null;
}
function buildEmbed(entry){
  const url = entry.url || '';
  const platform = detectPlatform(url);
  if (platform === 'youtube'){
    const id = entry.id || extractYouTubeId(url);
    if (!id) return null;
    const params = new URLSearchParams({
      rel: '0', modestbranding: '1', playsinline: '1', controls: '1', iv_load_policy: '3'
    });
    return {
      platform,
      src: `https://www.youtube.com/embed/${encodeURIComponent(id)}?${params.toString()}`,
      titleSuffix: 'YouTube'
    };
  }
  if (platform === 'facebook'){
    try{
      const href = encodeURIComponent(new URL(url).toString());
      const params = new URLSearchParams({
        href,
        show_text: '0',
        width: '1280',
        height: '720'
      });
      return {
        platform,
        src: `https://www.facebook.com/plugins/video.php?${params.toString()}`,
        titleSuffix: 'Facebook'
      };
    }catch(e){
      return null;
    }
  }
  return null;
}

/* === Gate logic === */
(function(){
  const gate = document.getElementById('gate');

  if (!PASSWORD_REQUIRED){
    if(gate) gate.style.display = 'none';
    initPage();
    return;
  }

  const cfg = JSON.parse(document.getElementById('auth-config').textContent);
  const btn = document.getElementById('btn');
  const pwd = document.getElementById('pwd');

  pwd.addEventListener('keypress', e => { if(e.key === 'Enter') btn.click(); });

  btn.addEventListener('click', async () => {
    const val = pwd.value || '';
    if(!val){ pwd.focus(); return; }
    btn.disabled = true; btn.textContent = 'Checking…';
    const ok = await verifyPassword(val, cfg);
    if(ok){
      try{ sessionStorage.setItem('yt_gate_ok', '1'); }catch(e){}
      gate.style.display = 'none';
      initPage();
    } else {
      location.replace('https://www.google.com');
    }
  });

  try{
    if(sessionStorage.getItem('yt_gate_ok') === '1'){ gate.style.display = 'none'; initPage(); }
  }catch(e){}
})();

/* === Page builder === */
function initPage(){
  const root = document.getElementById('root');
  const list = Array.isArray(window.VIDEOS) ? window.VIDEOS : [];

  const normalized = list.map((x, idx) => {
    const embed = buildEmbed(x || {});
    return { ...x, __embed: embed, __idx: idx };
  }).filter(v => v.__embed && v.__embed.src);

  if(normalized.length===0){
    root.innerHTML = '<div class="panel"><div style="color:#bbb">No embeddable videos found.</div></div>';
    return;
  }

  normalized.forEach(v => {
    const section = document.createElement('section'); section.className='panel';
    const wrap = document.createElement('div'); wrap.className='wrap';
    const player = document.createElement('div'); player.className='player';
    const iframe = document.createElement('iframe');

    const safeTitle = (v.title && String(v.title).trim())
      ? String(v.title).trim()
      : `${v.__embed.titleSuffix} video ${v.__idx + 1}`;

    iframe.setAttribute('title', safeTitle);
    iframe.setAttribute('allow','accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share');
    iframe.setAttribute('referrerpolicy','strict-origin-when-cross-origin');
    iframe.setAttribute('loading','lazy');
    iframe.setAttribute('allowfullscreen','true');

    iframe.dataset.src = v.__embed.src; // lazy

    player.appendChild(iframe);

    const label = document.createElement('div');
    label.className = 'label';
    label.textContent = (v.title && String(v.title).trim()) ? String(v.title).trim() : '';

    wrap.appendChild(player);
    if(label.textContent) wrap.appendChild(label);
    section.appendChild(wrap);
    root.appendChild(section);
  });

  const io = ('IntersectionObserver' in window) ? new IntersectionObserver(entries=>{
    entries.forEach(entry=>{
      if(entry.isIntersecting){
        const ifr = entry.target.querySelector('iframe');
        if(ifr && !ifr.src) ifr.src = ifr.dataset.src;
      }
    });
  }, {root:null, rootMargin:'200px 0px', threshold:0.1}) : null;

  if(io) document.querySelectorAll('.panel').forEach(p=>io.observe(p));
  else document.querySelectorAll('iframe').forEach(ifr=>{ if(!ifr.src) ifr.src=ifr.dataset.src; });

  const hint = document.getElementById('hint'); let h=false;
  window.addEventListener('scroll', ()=>{ if(!h){ h=true; hint.classList.add('hidden'); } }, {passive:true});
  setTimeout(()=>hint.classList.add('hidden'), 4000);
}
</script>
</body>
</html>
